[workspace]
authors = ["ZHU Yuhao (朱宇浩) <dr.yuhao.zhu@outlook.com>"]
channels = [
  "https://conda.modular.com/max",
  "https://repo.prefix.dev/modular-community",
  "conda-forge",
]
description = "A command-line argument parser library for Mojo"
license = "Apache-2.0"
name = "argmojo"
platforms = ["osx-arm64", "linux-64"]
readme = "README.md"
version = "0.1.0"

[dependencies]
mojo = "==0.26.1"
python = ">=3.13,<3.14"

[tasks]
# format the code
format = "mojo format ./src ./tests ./examples"

# compile the package
package = "mojo package src/argmojo -o argmojo.mojopkg"

# run tests
test = """\
    pixi run format \
    && pixi run package \
    && mojo run -I src tests/test_parse.mojo \
    && mojo run -I src tests/test_groups.mojo \
    && mojo run -I src tests/test_collect.mojo \
    && mojo run -I src tests/test_help.mojo \
    && mojo run -I src tests/test_extras.mojo \
    && mojo run -I src tests/test_subcommands.mojo \
    && mojo run -I src tests/test_negative_numbers.mojo \
    && mojo run -I src tests/test_persistent.mojo"""

# run demo
demo = "pixi run package && mojo run -I src examples/demo.mojo"

# run subcommand data model demo (Phase 4 Step 1)
demo_subcommands = "pixi run package && mojo run -I src examples/demo_subcommands.mojo"

# run negative number passthrough demo
demo_negative = "pixi run package && mojo run -I src examples/demo_negative.mojo"

# run persistent flags demo
demo_persistent = "pixi run package && mojo run -I src examples/demo_persistent.mojo"

# build demo binary
build_demo = "pixi run package && mojo build -I src examples/demo.mojo -o demo"

# clean build artifacts
clean = "rm -f argmojo.mojopkg demo"
