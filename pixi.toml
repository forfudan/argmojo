[workspace]
authors = ["ZHU Yuhao (朱宇浩) <dr.yuhao.zhu@outlook.com>"]
channels = [
  "https://conda.modular.com/max",
  "https://repo.prefix.dev/modular-community",
  "conda-forge",
]
description = "A command-line argument parser library for Mojo"
license = "Apache-2.0"
name = "argmojo"
platforms = ["osx-arm64", "linux-64"]
readme = "README.md"
version = "0.2.0"

[dependencies]
mojo = "==0.26.1"
python = ">=3.13,<3.14"

[tasks]
# format the code
format = "mojo format ./src ./tests ./examples"

# compile the package
package = "mojo package src/argmojo -o argmojo.mojopkg"

# run tests
test = """\
    pixi run format \
    && pixi run package \
    && mojo run -I src tests/test_parse.mojo \
    && mojo run -I src tests/test_groups.mojo \
    && mojo run -I src tests/test_collect.mojo \
    && mojo run -I src tests/test_help.mojo \
    && mojo run -I src tests/test_extras.mojo \
    && mojo run -I src tests/test_subcommands.mojo \
    && mojo run -I src tests/test_negative_numbers.mojo \
    && mojo run -I src tests/test_persistent.mojo"""

# build example binaries
build = """pixi run package \
&& mojo build -I src examples/grep.mojo -o grep \
&& mojo build -I src examples/git.mojo -o git"""

# clean build artifacts
clean = "rm -f argmojo.mojopkg grep git demo"
